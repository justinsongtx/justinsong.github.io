<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>XX视频图片上传小记 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="健忘越来越严重，记一下，以防失忆  ###一. 业务操作流程  约定图片尺寸  大图：最长边不超过800px 缩略图：最长边不超过400px   操作流程  从相册选择图片  转存图片到本地（不要依赖相册选择器返回的路径，不准！）  调用SDK上传图片到腾讯云  拿到URL结果，替换域名  把”cos.ap-guangzhou.myqcloud.com“ 替换成 ”image.myqcloud.">
<meta property="og:type" content="article">
<meta property="og:title" content="XX视频图片上传小记">
<meta property="og:url" content="http://yoursite.com/2020/09/21/XX%E8%A7%86%E9%A2%91%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E5%B0%8F%E8%AE%B0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="健忘越来越严重，记一下，以防失忆  ###一. 业务操作流程  约定图片尺寸  大图：最长边不超过800px 缩略图：最长边不超过400px   操作流程  从相册选择图片  转存图片到本地（不要依赖相册选择器返回的路径，不准！）  调用SDK上传图片到腾讯云  拿到URL结果，替换域名  把”cos.ap-guangzhou.myqcloud.com“ 替换成 ”image.myqcloud.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF">
<meta property="og:image" content="http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF?imageView2/2/w/100/h/100">
<meta property="article:published_time" content="2020-09-20T16:36:22.000Z">
<meta property="article:modified_time" content="2020-09-20T16:36:59.886Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF">
  
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
  <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightBlock(block);
      });
    });
  </script>
  
<link rel="stylesheet" href="/css/index.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body style="


  background-color: #eff0f6

">
  <div id="container">
    <nav id="nav">
  <header class="header">
    <a href="/" class="title">Clover Tuan</a>
  </header>
  <div class="ctnWrap">
    <div class="icons">
      
        
          
            <a href="https://dribbble.com/clovertuan" target="_blank" class="nav-icn iconfont icon-dribbble"></a>
          
        
          
            <a href="https://www.behance.net/clovertuan" target="_blank" class="nav-icn iconfont icon-behance"></a>
          
        
          
            <a href="http://clovertuan.lofter.com/" target="_blank" class="nav-icn iconfont icon-lofter"></a>
          
        
          
            <a href="https://www.instagram.com/clovertuan/" target="_blank" class="nav-icn iconfont icon-instagram"></a>
          
        
          
            <a href="https://github.com/cloverTuan" target="_blank" class="nav-icn iconfont icon-github"></a>
          
        
      
    </div>
    <div class="menu">
      
        
            <a href="/" class="nav-menu ">HOME</a>
          
        
            <a href="/archives" class="nav-menu ">ARCHIVE</a>
          
        
            <a href="/about" class="nav-menu ">ABOUT</a>
          
        
      
    </div>
  </div>
</nav>
    <div id="main"><section class="article">
  <h2 class="title">XX视频图片上传小记</h2>
  <p class="sub">Sep 21, 2020</p>
  <article class="content">
    <blockquote>
<p>健忘越来越严重，记一下，以防失忆</p>
</blockquote>
<p>###一. 业务操作流程</p>
<ol>
<li><p>约定图片尺寸</p>
<ul>
<li>大图：最长边不超过800px</li>
<li>缩略图：最长边不超过400px</li>
</ul>
</li>
<li><p>操作流程</p>
<ol>
<li><p>从相册选择图片</p>
</li>
<li><p>转存图片到本地（不要依赖相册选择器返回的路径，不准！）</p>
</li>
<li><p>调用SDK上传图片到腾讯云</p>
</li>
<li><p>拿到URL结果，替换域名</p>
<pre><code> 把”cos.ap-guangzhou.myqcloud.com“ 替换成 ”image.myqcloud.com“，这样才有cdn加速效果</code></pre></li>
<li><p>拼接下载规则</p>
<pre><code> 连接后拼上 ”?imageView2/2/w/800/h/800“ ， 规定最长边不超过800px</code></pre><p> 更多规则详见<a href="https://cloud.tencent.com/document/product/460/6929" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/460/6929</a></p>
</li>
<li><p>拿到处理完的URL</p>
<pre><code>  http://rijvideo-resource-1251316161.image.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF?imageView2/2/w/800/h/800</code></pre></li>
</ol>
</li>
</ol>
<p>###二. 背景知识</p>
<ol>
<li><p>腾讯云SDK</p>
<ul>
<li><p>SDK上传后返回的URL<br>  <a href="http://rijvideo-resource-1251316161.cos.ap-guangzhou.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF" target="_blank" rel="noopener">http://rijvideo-resource-1251316161.cos.ap-guangzhou.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF</a></p>
</li>
<li><p>URL域名<br>  cos.ap-guangzhou.myqcloud.com</p>
</li>
<li><p>服务器特点<br>  COS服务器，无加速，不可用数据万象图片处理功能</p>
</li>
</ul>
</li>
<li><p>数据万象</p>
<ul>
<li><p>URL格式<br>  <a href="http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF" target="_blank" rel="noopener">http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF</a></p>
</li>
<li><p>域名<br>  picgz.myqcloud.com</p>
</li>
<li><p>服务器特点<br>  数据万象服务器，无加速，可以使用数据万象图片处理功能</p>
</li>
<li><p>腾讯云返回的URL，如何使用数据万象服务<br>  将SDK返回的URL替换域名即可，将URL中的”cos.ap-guangzhou.myqcloud.com”替换为”picgz.myqcloud.com”</p>
<pre><code>  eg：
  替换域名前：http://rijvideo-resource-1251316161.cos.ap-guangzhou.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF
  替换域名后：http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF</code></pre></li>
<li><p>数据万象图片处理文档<br>  <a href="https://cloud.tencent.com/document/product/460/6929" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/460/6929</a></p>
</li>
<li><p>使用举例<br>  图片缩放，最长边不超过100，应选择规则2，在原URL后拼接”?imageView2/2/w/100/h/100”</p>
<pre><code>  原链接：http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF
  拼接结果：http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF?imageView2/2/w/100/h/100</code></pre><p>  <img src="http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF" alt="原图"><br>  <img src="http://rijvideo-resource-1251316161.picgz.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF?imageView2/2/w/100/h/100" alt="缩放后"></p>
</li>
</ul>
</li>
<li><p>Cdn加速</p>
<ul>
<li><p>URL格式<br>  <a href="http://rijvideo-resource-1251316161.image.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF?imageView2/1/w/100/h/100" target="_blank" rel="noopener">http://rijvideo-resource-1251316161.image.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF?imageView2/1/w/100/h/100</a></p>
</li>
<li><p>域名<br>  image.myqcloud.com</p>
</li>
<li><p>服务器特点<br>  数据万象服务器，有加速，可以使用数据万象图片处理功能</p>
</li>
<li><p>如何使用<br>  将SDK返回的URL替换域名即可，将URL中的”cos.ap-guangzhou.myqcloud.com”替换为”image.myqcloud.com”</p>
<pre><code>  eg：
  替换域名前：http://rijvideo-resource-1251316161.cos.ap-guangzhou.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF
  替换域名后：http://rijvideo-resource-1251316161.image.myqcloud.com/047E82FC-1E01-4FD1-9CFA-21D2745F454C.GIF</code></pre></li>
</ul>
</li>
</ol>
<p>###三. 关于上传的一些策略</p>
<ol>
<li><p>超时时间</p>
<ul>
<li>wifi：30s</li>
<li>xg：60s</li>
</ul>
</li>
<li><p>分片策略</p>
<ul>
<li>1M一片</li>
<li>最多并行4片</li>
</ul>
</li>
<li><p>断点重传</p>
<ul>
<li>基于分片，以分片为原子元素，上传失败整片开始重传</li>
</ul>
</li>
</ol>
<p>###三. 文档链接</p>
<ol>
<li><p>腾讯云SDK文档<br><a href="https://cloud.tencent.com/document/product/436/11280" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/436/11280</a></p>
</li>
<li><p>数据万象接口文档<br><a href="https://cloud.tencent.com/document/product/460/10511" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/460/10511</a></p>
</li>
</ol>
<p>（完）</p>

  </article>
  <footer class="f-cf">
    
      <a href="/2020/09/21/MarkDown%E5%85%BC%E5%AE%B9OutLook%E5%B0%8F%E8%AE%B0/" class="link f-fl">⟵MarkDown兼容OutLook小记</a>
    
    
      <a href="/2020/09/21/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%8F%91%E5%B8%83%E5%A4%B1%E8%B4%A5-ITMS-90034-Missing-or-invalid-signature/" class="link f-fr">记一次发布失败 ITMS-90034: Missing or invalid signature⟶</a>
    
  </footer>
</section></div>
    <footer id="footer" class="f-cf">
  d.guangying@foxmail.com
  
    
      
        · <a href="https://dribbble.com/clovertuan" target="_blank" class="nav-icn">Dribbble</a>
      
    
      
        · <a href="https://www.behance.net/clovertuan" target="_blank" class="nav-icn">Behance</a>
      
    
      
        · <a href="http://clovertuan.lofter.com/" target="_blank" class="nav-icn">Lofter</a>
      
    
      
        · <a href="https://www.instagram.com/clovertuan/" target="_blank" class="nav-icn">Instagram</a>
      
    
      
        · <a href="https://github.com/cloverTuan" target="_blank" class="nav-icn">GitHub</a>
      
    
  
  <span class="copyright">All rights reserved @Clover Tuan</span>
</footer>
  </div>
</body>
</html>